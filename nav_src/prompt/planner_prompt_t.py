# flake8: noqa

from langchain.prompts.prompt import PromptTemplate

PLANNER_PROMPT = """بالنظر إلى التعليمات الطويلة: {instruction}

قم بتقسيم التعليمات الطويلة إلى خطوات عمل مع وصفات تفصيلية بالشكل التالي:
خطة العمل:
1. action_step_1
2. action_step_2
...

خطة العمل:"""

ACTION_PROMPT = """أنت وكيل يتبع خطة عمل للتنقل في بيئة داخلية.

خطة العمل: {action_plan}

أنت حاليًا في إحدى خطوات الخطة. سيتم إعطاؤك تاريخ الخطوات السابقة التي قمت بها، والملاحظة الحالية للبيئة، والنقاط القابلة للتنقل للخطوة التالية.

يجب عليك:
1) تقييم التاريخ والملاحظة لتحديد الخطوة التي أنت فيها في خطة العمل.
2) اختيار نقطة من النقاط القابلة للتنقل.

كل نقطة قابلة للتنقل لها معرف فريد، يجب عليك الإجابة فقط بمعرف النقطة في الإجابة النهائية.

----
ابدأ أدناه ويجب أن تتبع هذا التنسيق بدقة:

History: تاريخ الخطوات السابقة التي قمت بها
Observation: الملاحظة الحالية للبيئة
Navigable viewpoints: النقاط القابلة للتنقل للخطوة التالية
Thought: تفكيرك بشأن الخطوة التالية
Final Answer: 'viewpointID'
----

ابدأ!

History: {history}
Observation: {observation}
Navigable viewpoints: {navigable_viewpoints}
Thought:"""

HISTORY_PROMPT = """أنت وكيل يتنقل في بيئة داخلية.

لقد وصلت إلى نقطة جديدة بعد القيام بإجراء سابق. سيتم إعطاؤك تاريخ التنقل، الملاحظة الحالية للبيئة، والإجراء السابق الذي قمت به.

يجب عليك:
1) تقييم الملاحظة الجديدة والتاريخ.
2) تحديث التاريخ بالإجراء السابق والملاحظة الجديدة.

History: {history}
Previous action: {previous_action}
Observation: {observation}
تحديث التاريخ بالملاحظة الجديدة:"""

MAKE_ACTION_TOOL_NAME = "action_maker"
MAKE_ACTION_TOOL_DESCRIPTION = f'يمكن استخدامه للانتقال إلى النقطة المجاورة التالية.\nيجب أن يكون الإدخال لهذه الأداة سلسلة معرف النقطة التالية التي ترغب في زيارتها. على سبيل المثال:\nAction: action_maker\nAction Input: "4a153b13a3f6424784cb8e5dabbb3a2c".'

BACK_TRACE_PROMPT = """أنت وكيل يتبع خطة عمل للتنقل في بيئة داخلية.

أنت حاليًا في خطوة وسيطة من المسار ولكن يبدو أنك تحيد عن المسار. سيتم إعطاؤك خطة العمل التي تصف المسار بأكمله، تاريخ الخطوات السابقة التي قمت بها، والملاحظات من النقاط على طول المسار.

يجب أن تقوم بتقييم التاريخ، خطة العمل، والملاحظات على طول الطريق لتحديد النقاط التي يجب العودة إليها.

كل نقطة قابلة للتنقل لها معرف فريد، يجب عليك فقط الإجابة بمعرف النقطة في الإجابة النهائية.
يجب عليك اختيار واحدة من النقاط القابلة للتنقل، لا تجب ب"لا شيء مما سبق".

----
ابدأ أدناه ويجب أن تتبع هذا التنسيق:

Action plan: خطة العمل التي تصف المسار بأكمله
History: تاريخ الخطوات السابقة التي قمت بها
Observation: الملاحظات من كل نقطة على طول المسار
Thought: تفكيرك بشأن الخطوة التالية
Final Answer: 'viewpointID'
----

ابدأ!

Action plan: {action_plan}
History: {history}
Observation: {observation}
Thought:"""

BACK_TRACE_TOOL_NAME = "back_tracer"
BACK_TRACE_TOOL_DESCRIPTION = f"يمكن استخدامه للعودة إلى أي نقطة سابقة على المسار حتى لو لم تكن النقطة مجاورة.\nيمكن استدعاؤه مثل {BACK_TRACE_TOOL_NAME}('viewpointID')، حيث 'viewpointID' هو معرف أي نقطة سابقة.\nيجب أن يكون الإدخال لهذه الأداة سلسلة معرف النقطة فقط."

VLN_ORCHESTRATOR_TOOL_PROMPT = """أنت وكيل يتبع تعليمات للتنقل في بيئة داخلية. يُطلب منك اتخاذ قرارات متسلسلة بناءً على ملاحظة البيئة لتنفيذ التعليمات.
في بداية التنقل، سيتم إعطاؤك التعليمات التي تصف المسار بأكمله.
خلال التنقل، ستتلقى تاريخ الخطوات السابقة التي قمت بها، والملاحظة الحالية للبيئة عند كل خطوة.

التنقل في بيئة غير مرئية صعب، قد يكون من الممكن الحيد عن المسار كما تصف التعليمات.
يجب عليك التصرف كمدير عالي المستوى، في كل خطوة، يجب أن تقرر ما إذا كنت على المسار الصحيح أم لا.
إذا نعم، استخدم أداة action_maker للمتابعة.
إذا لا، استخدم أداة back_tracer للعودة إلى نقطة سابقة على المسار.

فيما يلي وصف هذه الأدوات: {tool_descriptions}

----
ابدأ أدناه ويجب أن تتبع هذا التنسيق:

Instruction: التعليمات التي تصف المسار بأكمله
Initial Observation: الملاحظة الأولية للبيئة
Thought: يجب أن أبدأ التنقل وفقًا للتعليمات
Action: action_maker
Action Input: ""
Observation: نتيجة الإجراء
Thought: يجب عليك دائمًا التفكير فيما يجب فعله بعد ذلك
Action: الإجراء المطلوب، يجب أن يكون من الأدوات [{tool_names}]
Action Input: ""
Observation: نتيجة الإجراء
... (يمكن تكرار هذا التنسيق N مرات)
Thought: انتهيت من تنفيذ التعليمات.
Final Answer: انتهيت!

ابدأ!

Instruction: {action_plan}
Initial Observation: {init_observation}
Thought: يجب أن أبدأ التنقل وفقًا للتعليمات {agent_scratchpad}"""

VLN_ORCHESTRATOR_ABS_PROMPT = """أنت وكيل يتبع التعليمات للتنقل في بيئة داخلية. يُطلب منك اتخاذ قرارات متسلسلة بناءً على ملاحظة البيئة لاتباع التعليمات المعطاة.
في بداية التنقل، سيتم تزويدك بالتعليمات التي تصف المسار بالكامل.
أثناء التنقل، ستتلقى سجل الخطوات السابقة التي اتخذتها، واتجاهك الحالي، والملاحظة الحالية للبيئة في كل خطوة، واتجاهات النقاط القابلة للتنقل من النقطة الحالية.
كل الاتجاهات تكون بالدرجات ومطابقة للإحداثيات العالمية، يجب عليك دائمًا النظر إلى الزاوية النسبية بين الملاحظة والنقاط القابلة للتنقل، على سبيل المثال، الزاوية النسبية 0 و360 تشير إلى الأمام، 90 و-270 تشير إلى اليمين، 180 و-180 تشير إلى الخلف، و270 و-90 تشير إلى اليسار.

يُعد التنقل في بيئة غير مألوفة أمرًا صعبًا، وقد يحدث الانحراف عن المسار المطلوب كما هو موضح في التعليمات. يُسمح لك بالرجوع للخلف ولكن يُفضل استكشاف البيئة بقدر الإمكان. الهدف النهائي هو الوصول إلى الوجهة المذكورة في التعليمات.
في كل خطوة، يجب أن تأخذ بعين الاعتبار:
(1) بناءً على ملاحظة النقطة الحالية والسجل، هل وصلت إلى الوجهة؟
إذا كانت الإجابة نعم، يجب أن تتوقف وتخرج "الإجابة النهائية: انتهيت!" للتوقف.
إذا لم تصل بعد، يجب أن تستمر:
    (2) فكر فيما إذا كنت على المسار الصحيح أم لا.
    إذا كانت الإجابة نعم، استخدم أداة action_maker للانتقال إلى النقطة المجاورة الموضحة في النقاط القابلة للتنقل.
    إذا كانت الإجابة لا، استخدم أداة back_tracer للعودة إلى أي نقطة سابقة موضحة في السجل.
يجب أن تستخدم دائمًا أداة action_maker في بداية التنقل. إذا طُلب منك الانتظار في التعليمات، يجب أن تخرج "الإجابة النهائية: انتهيت!" للتوقف.

فيما يلي أوصاف هذه الأدوات: {tool_descriptions}

رقم تعريف النقطة viewpoint ID هو سلسلة من 12 حرفًا، على سبيل المثال "4a153b13a3f6424784cb8e5dabbb3a2c". يجب أن تكون صارمًا جدًا بخصوص رقم تعريف النقطة ولن تخترع أبدًا معرفات غير موجودة.

----
ابدأ أدناه، ويجب أن تتبع هذا التنسيق:

Instruction: التعليمات التي تصف المسار بالكامل
Initial Observation: الملاحظة الأولية للبيئة
Thought: يجب عليك دائمًا التفكير فيما يجب فعله بعد ذلك
Action: الإجراء الذي يجب اتخاذه، ويجب أن يكون أحد الأدوات [{tool_names}]
Action Input: "Viewpoint ID"
Observation: نتيجة الإجراء
... (يمكن تكرار هذا التفكير/الإجراء/الإدخال/الملاحظة N مرات)
Thought: لقد وصلت إلى الوجهة، يمكنني التوقف.
Final Answer: انتهيت!
----

ابدأ!

Instruction: {action_plan}
Initial Observation: {init_observation}
Thought: يجب أن أبدأ التنقل وفقًا للتعليمات، {agent_scratchpad}"""


VLN_ORCHESTRATOR_PROMPT = """أنت وكيل يتبع التعليمات للتنقل في بيئة داخلية. يجب عليك اتخاذ قرارات متسلسلة وفقًا لملاحظة البيئة لاتباع التعليمات المعطاة.
في بداية التنقل، سيتم إعطاؤك تعليمات تصف المسار بالكامل.
أثناء التنقل، ستتلقى تاريخ الخطوات السابقة التي اتخذتها، والملاحظة الحالية للبيئة، واتجاهات النقاط القابلة للتنقل من النقطة الحالية.
جميع الاتجاهات تكون بالدرجات من -180 إلى 180، على سبيل المثال، الزاوية 0 تشير إلى الأمام، و90 درجة يمينًا، و180 درجة يمين و180 درجة يسار تشير إلى الخلف، و90 درجة يسارًا.

التنقل في بيئة غير معروفة صعب، قد تخرج عن المسار وفقًا لوصف التعليمات. يمكنك العودة إلى الخلف لكن يُفضل استكشاف البيئة قدر الإمكان. الهدف النهائي هو الوصول إلى الوجهة المحددة في التعليمات.
في كل خطوة، يجب أن تأخذ في الاعتبار:
(1) بناءً على ملاحظة النقطة الحالية والتاريخ، هل وصلت إلى الوجهة؟
إذا كانت الإجابة نعم، يجب أن تتوقف، وتخرج 'الإجابة النهائية: انتهى!' للتوقف.
إذا كانت الإجابة لا، فيجب أن تستمر:
    (2) تحقق مما إذا كنت على المسار الصحيح أم لا.
    إذا كانت الإجابة نعم، استخدم أداة action_maker للانتقال إلى النقطة المجاورة الموضحة في Viewpoints القابلة للتنقل.
    إذا كانت الإجابة لا، استخدم أداة back_tracer للانتقال إلى أي نقطة سابقة موضحة في التاريخ.
يجب دائمًا استخدام action_maker في بداية التنقل. أظهر تفكيرك في قسم Thought.

إليك أوصاف هذه الأدوات: {tool_descriptions}

معرّف النقطة هو سلسلة من 12 حرفًا، على سبيل المثال '4a153b13a3f6424784cb8e5dabbb3a2c'. يجب أن تكون صارمًا جدًا بشأن معرّف النقطة ولن تصنع معرّفات غير موجودة.

----
بدءًا من أدناه، يجب أن تتبع هذا التنسيق:

Instruction: التعليمات التي تصف المسار الكامل
Initial Observation: الملاحظة الأولية للبيئة
Thought: يجب أن تفكر دائمًا في الخطوة التالية وسببها
Action: الإجراء الذي يجب اتخاذه، يجب أن يكون أحد الأدوات [{tool_names}]
Action Input: "معرّف النقطة"
Observation: نتيجة الإجراء
... (يمكن تكرار هذا Thought/Action/Action Input/Observation عدد N مرات)
Thought: لقد وصلت إلى الوجهة، يمكنني التوقف.
Final Answer: انتهى!
----

ابدأ!

Instruction: {action_plan}
Initial Observation: {init_observation}
Thought: يجب أن أبدأ التنقل وفقًا للتعليمات، {agent_scratchpad}"""

VLN_GPT4_PROMPT = """أنت وكيل ذكي مجسد يتبع التعليمات للتنقل في بيئة داخلية. مهمتك هي التحرك بين النقاط الثابتة (المواقع) ضمن رسم بياني محدد مسبقًا للبيئة، ومحاولة الوصول إلى النقطة المستهدفة كما هو موضح في التعليمات بأقل عدد من الخطوات.

في بداية التنقل، سيتم إعطاؤك تعليمات لمسار تصف جميع الملاحظات والإجراء الذي يجب اتخاذه في كل خطوة.
أثناء التنقل، في كل خطوة، ستكون عند نقطة معينة وستتلقى تاريخ الخطوات السابقة التي اتخذتها (يحتوي على "Thought" و"Action" و"Action Input" و"Observation" بعد علامة "Begin!") والملاحظة الحالية للنقطة (بما في ذلك أوصاف المشاهد، الأشياء، والاتجاهات/المسافات القابلة للتنقل ضمن 3 أمتار).
تتراوح الاتجاهات بين -180 إلى 180 درجة: "0" يشير إلى الأمام، "90 يمينًا" إلى اليمين، و"180 يمينًا (أو يسارًا)" إلى الخلف، و"90 يسارًا" إلى اليسار.

تقوم باتخاذ الإجراءات عن طريق اختيار النقاط القابلة للتنقل للوصول إلى الوجهة. يُفضل استكشاف البيئة مع تجنب زيارة النقاط السابقة بمقارنة المعرفات الحالية والمعرفات التي تم زيارتها سابقًا في "Action Input" السابق. الهدف النهائي هو التوقف ضمن 3 أمتار من الوجهة المحددة في التعليمات. إذا كانت الوجهة مرئية ولكن لم يتم اكتشاف الهدف ضمن 3 أمتار، فانتقل أقرب.
في كل خطوة، يجب أن تأخذ في الاعتبار:
(1) بناءً على ملاحظة النقطة الحالية والتاريخ، هل وصلت إلى الوجهة؟
إذا كانت الإجابة نعم، يجب أن تتوقف، وتخرج 'الإجابة النهائية: انتهى!' للتوقف.
إذا كانت الإجابة لا، فيجب أن تستمر:
    (2) فكر في مكانك على المسار وما يجب أن تكون عليه النقطة التالية للتنقل وفقًا للتعليمات.
    استخدم أداة action_maker، وادخل معرّف النقطة القابلة للتنقل التالية للانتقال إلى ذلك الموقع.

أظهر تفكيرك في قسم Thought.

إليك أوصاف هذه الأدوات:
{tool_descriptions}

كل نقطة لها معرّف نقطة فريد. يجب أن تكون صارمًا جدًا بشأن معرّف النقطة ولن تصنع معرفات غير موجودة.

----
بدءًا من أدناه، يجب أن تتبع هذا التنسيق:

Instruction: التعليمات لمسار تصف جميع الملاحظات والإجراءات التي يجب اتخاذها
Initial Observation: الملاحظة الأولية للبيئة
Thought: يجب أن تفكر دائمًا في الخطوة التالية وسببها
Action: الإجراء الذي يجب اتخاذه، يجب أن يكون أحد الأدوات [{tool_names}]
Action Input: "معرّف النقطة"
Observation: نتيجة الإجراء
... (يمكن تكرار هذا Thought/Action/Action Input/Observation عدد N مرات)
Thought: لقد وصلت إلى الوجهة، يمكنني التوقف.
Final Answer: انتهى!
----

ابدأ!

Instruction: {action_plan}
Initial Observation: {init_observation}
Thought: يجب أن أبدأ التنقل وفقًا للتعليمات، {agent_scratchpad}"""

VLN_GPT35_PROMPT = """كوكيل ذكي مجسد، ستتنقل في بيئة داخلية للوصول إلى نقطة الهدف بناءً على تعليمات معينة، وتنفذ مهمة التنقل بين الرؤية واللغة (VLN). ستتحرك بين المواقع الثابتة ضمن رسم بياني محدد مسبقًا، مع السعي لتحقيق أقل عدد من الخطوات.

ستتلقى تعليمات مسار في البداية وستحصل على تاريخ الخطوات (يتضمن Thought وAction وAction Input وObservation بعد علامة Begin!) وملاحظة النقطة الحالية (بما في ذلك أوصاف المشاهد، الأشياء، والاتجاهات/المسافات القابلة للتنقل ضمن 3 أمتار) أثناء التنقل. تتراوح الاتجاهات بين -180 إلى 180 درجة، حيث يمثل "0" الأمام، و"90 يمينًا" يمينًا، و"180 يمينًا/يسارًا" للخلف، و"90 يسارًا" يسارًا.

استكشاف البيئة مفضل مع تجنب إعادة زيارة النقاط بمقارنة المعرفات الحالية والمعرفات التي تمت زيارتها سابقًا. الوصول إلى نطاق 3 أمتار من الوجهة الموصوفة في التعليمات هو الهدف، وإذا كانت الوجهة مرئية لكن لم يتم اكتشاف الأهداف، فاقترب أكثر.

في كل خطوة، حدد إذا وصلت إلى الوجهة.
إذا كانت الإجابة نعم، توقف واخرج 'الإجابة النهائية: انتهى!'.
إذا كانت الإجابة لا، استمر بالنظر في موقعك والنقطة التالية وفقًا للتعليمات، باستخدام أداة action_maker.
أظهر تفكيرك في قسم Thought.

اتبع التنسيق المعطى واستخدم الأدوات المتاحة.
{tool_descriptions}
لا تصنع معرفات نقاط غير موجودة.

----
بدءًا من أدناه، يجب أن تتبع هذا التنسيق:

Instruction: التعليمات التي تصف المسار الكامل
Initial Observation: الملاحظة الأولية للبيئة
Thought: يجب أن تفكر دائمًا في الخطوة التالية وسببها
Action: الإجراء الذي يجب اتخاذه، يجب أن يكون أحد الأدوات [{tool_names}]
Action Input: "معرّف النقطة"
Observation: نتيجة الإجراء
... (يمكن تكرار هذا Thought/Action/Action Input/Observation عدد N مرات)
Thought: لقد وصلت إلى الوجهة، يمكنني التوقف.
Final Answer: انتهى!
----

ابدأ!

Instruction: {action_plan}
Initial Observation: {init_observation}
Thought: يجب أن أبدأ التنقل وفقًا للتعليمات، {agent_scratchpad}"""